### How to collect sensor data on your iPhone or Android device using Matlab
### Introduction
Have you ever been in a situation where you are trying to build a project but are still waiting on sensors that haven't even left the warehouse? Well,there is a solution to this. Did you know you can use your smartphone for those tasks? Smartphones have several sensors, and with the Matlab mobile app, you can use some of those sensors to collect and analyze data.
Sensors are electrical devices that are for the detection of various conditions or objects. They use signals to detect the various conditions and objects.Therefore, sensors form an essential part of sensor involved project. This tutorial will look at how we can collect data using smartphones' sensors and use these data for various projects.

### Prerequisites
- [Matlab](https://www.mathworks.com/products/get-matlab.html?s_tid=gn_getml) installed.
- Proper understanding of [matlab](https://www.section.io/engineering-education/getting-started-with-matlab/) basics.
- Mobile matlab installed on your phone.

To install Matlab mobile app on your phone, go to the play store or AppStore and search `Matlab`. Once you locate this, click on the install, and you shall have installed Matlab into your phone.

### How to use mobile phone's Matlab to take photos of images
You can access the camera to take an image or video manually. This image or video you can later use in your program for analysis. To access the camera, 
- Open the Matlab on your mobile phone.
> Note that mobile Matlab works online, and you must have an internet connection to use it.
- Click on the three dashes at the top-left of the Matlab window.
![location of the dashes](/how-to-collect-sensor-data-on-your-iphone-or-android-device-using-matlab/engineering-education/sensor_one.jpeg)
- Click on the file section.
![location of the files](/how-to-collect-sensor-data-on-your-iphone-or-android-device-using-matlab/engineering-education/sensor_two.jpeg)
- Click on the `+` sign at the top-right corner.
- Click on the `Take a photo` button to take a photo of your image.
![tab for taking the photo](/how-to-collect-sensor-data-on-your-iphone-or-android-device-using-matlab/engineering-education/sensor_three.jpeg)

Using the camera on the Matlab mobile app is easy and intuitive, just like you would on most applications. After taking an image, it is uploaded to a Matlab drive to sync all your files and data. The image is uploaded in the `.jpeg` format with an autogenerated name. Since you are going to use this image, you can rename it to be something meaningful. To rename the image, we long-press it, click on the `rename` tab, and give it a name you wish. After giving it a new name, you click `ok`. 
Let us now go back to the command window and begin writing some codes. We will view the image using the `imread` function and then use the `imshow` function to view it. 
```Matlab
I = imread('filename.jpg');
imshow(I)
```
![showing our captured image](/how-to-collect-sensor-data-on-your-iphone-or-android-device-using-matlab/engineering-education/sensor_four.jpeg)
After accessing your image, you can do anything you wish with the image. For example, you can change the image to grayscale and many more options. The code is;
```Matlab
B = rgb2gray(I);
imshow(B)
```
![the grayscale image](/how-to-collect-sensor-data-on-your-iphone-or-android-device-using-matlab/engineering-education/sensor_five.jpeg)
As you can see, it was easy to use our mobile Matlab to acquire the image and perform some quick image processing. You can write all your commands in a script so that you can use them anytime on your mobile Matlab or desktop, or laptop. First, click on the `+` sign on the file section and click on the `script.`
This technology makes it possible to use your commands anywhere in the Matlab drive, where you are syncing all your files and data. Once you sync all the data into your Matlab drive, you can access them in your Matlab drive. Alternatively, you can access these data online on your Matlab drive. To do this,
click [here](https://www.mathworks.com/products/matlab-drive.html) and click on `Matlab drive online`.
![location of Matlab drive online](/howto-collect-sensor-data-on-your-iphone-or-android-device-using-matlab/engineering-education/sensor_six.png)
When you click on the `Matlab drive online`, provide your information to log into your Mathworks account. When this is successful, you will find all your files here. You can download this data into your pc and use them from there. 
![structure of the drive](/how-to-collect-sensor-data-on-your-iphone-or-android-device-using-matlab/engineering-education/sensor_seven.png)

### Using phone sensors
These sensors are;
- Acceleration sensors
- Angular velocity sensors
- Orientation sensors
- Magnetic field sensors
- Position sensors

To access the sensors, click on the file menu and then sensors. When you open the sensor window, you find the various sensors provided by your phone. You can log data from all these available sensors or just one sensor depending on what you want to do. You can either log data and save it as a `.mat` file or stream data to Matlab. In this case, we will look at how to log data and access the collected data. We are going to use the collected data to calculate the distance traveled. To collect data to calculate the distance, we are going to collect latitudinal and longitudinal information. To do this, you will move with your phone as it collects the data. To set your phone for this, we will activate the position sensor then click on the start button for it to start collecting this data. Once you have done this, it starts collecting the data.

![data collection](/how-to-collect-sensor-data-on-your-iphone-or-android-device-using-matlab/engineering-education/sensor_eight.jpeg)

Once you are done collecting your data, you can click on the stop tab and save your file. It allows you to use the data later on your laptop or any other preferred place. This data is then uploaded to your Matlab drive.To use this data on your laptop, you log into your Mathworks account in the pc Matlab. The data is stored on the Matlab drive, and once you log in, You can now access it. Alternatively, you can use the previously explained method of using `Matlab drive online`. After accessing your data, you can use an algorithmto calculate the distance traveled. For example, we are going to use the haversine formula to calculate the distance traveled. We first load our data into Matlab. We first add the data path and then load the data as shown below;
```Matlab
%% load data acquired by position data
%load position data
addpath('/MATLAB Drive/MobileSensorData')
load sensorlog.mat
```
![loaded data](/how-to-collect-sensor-data-on-your-iphone-or-android-device-using-matlab/engineering-education/sensor_ten.png)
We then introduce the haversine formula. This formula uses the latitudinal and longitudinal positions to calculate the distance. These latitudinal and longitudinal are in degree. It means we will first convert them into radians before using them. Also, in this formula, the radius of the earth is considered.
```Matlab
%have haversine formula to calculate distance
latPos = deg2rad(Position.latitude);
lonPos = deg2rad(Position.longitude);
radiusEarth = 6370 ; % in Km
```
use vectorization to calculate total distance at every time step
```matlab
ii = 1:length(latPos)-1;
```
Since the data is large, it is first pre-processed. Once this is done, we then calculate the distance.
```matlab
% Prepare vector for calculation
lat1 = latPos(ii);
lat2 = latPos(ii+1);

lon1 = lonPos(ii);
lon2 = lonPos(ii+1);

difflat = lat2-lat1;
difflon = lon2 -lon1;

aa = sin(difflat/2).^2 + cos(lat1).*cos(lat2).*sinc(difflon/2).^2;
cc = 2.*atan2(sqrt(aa), sqrt(1-aa));
dd = radiusEarth*cc;

%% Total distance
distMiles = sum(dd)*0.621;
disp(distMiles)
```
When we execute the whole program, we get the distance traveled in kilometers. When we run the same script in the mobile Matlab, we get a similar answer as that of PC Matlab:

![](/how-to-collect-sensor-data-on-your-iphone-or-android-device-using-matlab/engineering-education/sensor_nine.png)
It is proof that these sensors are working and accurate. You can similarly use the remaining sensors to collect your data.

### Conclusion
Using a phone's sensor to collect data is easy. It involves the activation of the sensor and then beginning to the collection of data. It makes it an efficient way of collecting data in the absence of sensors. They provide accurate results which are reliable for any experiments. They are also easy to access since you only need to have the mobile Matlab app, and you are ready to collect the data. The significant advantage is that the data can be collected using a readily available resource(phone's sensor). You can be sure that if 80% of the day, you have your iPhone or Android phone with you, and you can collect any data anywhre, and anytime.
